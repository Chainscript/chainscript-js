#!/usr/bin/env node
/*eslint-disable */

var path = require('path');
var execFileSync = require('child_process').execFileSync;
var commander = require('commander');
var readPackageSync = require(path.resolve(
  __dirname,
  '../lib/utils/readPackageSync'
));
var verifyPDF = require(path.resolve(__dirname, '../lib/utils/verifyPDF'));

function handleError(err) {
  process.stderr.write(err.message + '\n', function() {
    process.exit(1);
  });
}

commander
  .version(readPackageSync('version'))
  .usage('[options] [hashes] [-- chainscript args]')
  .option('-r, --root <path>', 'JSON root path (default body.content.hash)')
  .parse(process.argv);

if (commander.args.length !== 1) {
  commander.outputHelp();
  process.exit(1);
}

verifyPDF(path.resolve(process.cwd(), commander.args[0]), commander.root)
  .then(function() {
    process.stdout.write('Success\n');
    process.exit(0);
  })
  .catch(handleError);
